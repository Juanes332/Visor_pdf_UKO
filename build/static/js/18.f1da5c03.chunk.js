(this["webpackJsonpmatx-react"]=this["webpackJsonpmatx-react"]||[]).push([[18],{1011:function(e,t,n){"use strict";n.r(t);var a=n(7),c=n(14),o=n(9),r=n(13),i=n(1),s=n.n(i),l=n(580),u=n(1045),d=n(1001),b=n(1015),j=n(23),f=n(972),p=n(738),h=n(978),O=n(979),m=n(980),g=n(981),x=n(982),v=n(983),y=n(984),S=n(1048),C=n(985),k=n(976),w=n(774),N=n.n(w),D=n(775),I=n.n(D),A=n(486),F=n(1030),B=n(1007),R=n(2),P=function(e){var t=e.onFilesSelected,n=Object(i.useState)(!1),a=Object(r.a)(n,2),c=a[0],o=a[1],s=Object(i.useState)(null),l=Object(r.a)(s,2),u=l[0],d=l[1],b=Object(i.useRef)(null),j=function(e){for(var n=0;n<e.length;n++){if("application/pdf"!==e[n].type)return d("Solo se permiten archivos PDF."),void(b.current.value="");if(e[n].size>10485760)return d("No se pueden subir archivos mayores a 10MB."),void(b.current.value="")}t(e),b.current.value=""};return Object(R.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",marginBottom:"620px",padding:"120px",border:"5px dashed #ccc",textAlign:"center",cursor:"pointer",background:c?"#f2f2f2":"white",borderRadius:"4px"},onDrop:function(e){e.preventDefault();var t=e.dataTransfer.files;j(t),o(!1)},onDragOver:function(e){e.preventDefault(),o(!0)},onDragLeave:function(){o(!1)},children:[Object(R.jsx)("div",{style:{marginBottom:"10px"},children:"Arrastra y suelta archivos PDF aqu\xed"}),Object(R.jsx)("div",{style:{marginBottom:"10px"},children:"o"}),Object(R.jsx)(A.a,{variant:"contained",style:{backgroundColor:"#ff9e43"},onClick:function(){b.current.click()},children:"Selecciona archivos"}),Object(R.jsx)("input",{type:"file",accept:".pdf",multiple:!0,onChange:function(e){var t=e.target.files;j(t)},ref:b,style:{display:"none"}}),Object(R.jsx)(F.a,{open:!!u,autoHideDuration:6e3,onClose:function(){return d(null)},anchorOrigin:{vertical:"top",horizontal:"right"},children:Object(R.jsx)(B.a,{onClose:function(){return d(null)},severity:"Solo se permiten archivos PDF."===u?"warning":"error",children:u})})]})},z=n(910),T=n(1016),J=n(735),L=n.n(J),H=Object(f.a)((function(e){return{paper:{position:"absolute",width:400,backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3)}}}));function M(){return{top:"".concat(50,"%"),left:"".concat(50,"%"),transform:"translate(-".concat(50,"%, -").concat(50,"%)")}}var W=function(e){var t=e.isOpen,n=e.onClose,a=e.onSave,c=H(),o=s.a.useState(M),l=Object(r.a)(o,1)[0],u=Object(i.useRef)({});return Object(R.jsx)(T.a,{open:t,onClose:n,children:Object(R.jsxs)("div",{style:l,className:c.paper,children:[Object(R.jsx)("h2",{children:"Firma Aqu\xed"}),Object(R.jsx)(L.a,{ref:u,canvasProps:{width:500,height:200,className:"sigCanvas",onMouseDown:function(e){return e.stopPropagation()}}}),Object(R.jsxs)("div",{children:[Object(R.jsx)(k.a,{onClick:function(){u.current.clear()},children:"Borrar"}),Object(R.jsx)(k.a,{onClick:function(){a(u.current.getTrimmedCanvas().toDataURL("image/png")),n()},children:"Guardar"}),Object(R.jsx)(k.a,{onClick:n,children:"Cancelar"})]})]})})},E={width:200,height:50},V=function(e){var t=e.id,n=e.documentId,a=e.pageNumber,c=e.onRemove,s=e.initialPosition,l=e.onPositionChange,u=localStorage.getItem("signature-".concat(n,"-").concat(a,"-").concat(t)),d=Object(i.useState)(u),b=Object(r.a)(d,2),j=b[0],f=b[1],p=Object(i.useState)(!1),h=Object(r.a)(p,2),O=h[0],m=h[1],g=Object(i.useState)(function(){for(var e="#",t=0;t<6;t++)e+="0123456789ABCDEF"[Math.floor(16*Math.random())];return e}()),x=Object(r.a)(g,2),v=x[0],y=x[1],S=Object(i.useState)(Object(o.a)({width:E.width,height:E.height},s)),C=Object(r.a)(S,2),k=C[0],w=C[1];Object(i.useEffect)((function(){var e=localStorage.getItem("signature-size-".concat(n,"-").concat(a,"-").concat(t));e&&w(JSON.parse(e))}),[t,n,a]);var N={border:"1px solid black",width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",position:"relative",backgroundColor:j?"transparent":v,backgroundImage:"url(".concat(j,")"),backgroundSize:"contain",backgroundRepeat:"no-repeat",backgroundPosition:"center"},D={position:"absolute",width:"10px",height:"10px",background:"#fff",border:"1px solid #007bff",borderRadius:"50%"};return Object(R.jsxs)(z.a,{size:{width:k.width,height:k.height},position:{x:k.x,y:k.y},default:Object(o.a)(Object(o.a)({},E),{},{x:s.x,y:s.y}),bounds:".documentContainer",minWidth:32.1094,minHeight:30.8594,maxWidth:380.172,maxHeight:200.431,onResizeStop:function(e,c,r,i,s){var l=Object(o.a)({width:r.style.width,height:r.style.height},s);w(l),localStorage.setItem("signature-size-".concat(n,"-").concat(a,"-").concat(t),JSON.stringify(l))},onDragStop:function(e,c){w((function(e){return Object(o.a)(Object(o.a)({},e),{},{x:c.x,y:c.y})})),localStorage.setItem("signature-size-".concat(n,"-").concat(a,"-").concat(t),JSON.stringify(Object(o.a)(Object(o.a)({},k),{},{x:c.x,y:c.y}))),l&&l(c.x,c.y)},enableResizing:{topLeft:!0,topRight:!0,bottomLeft:!0,bottomRight:!0},lockAspectRatio:!0,children:[Object(R.jsxs)("div",{style:Object(o.a)(Object(o.a)({},N),{},{border:"1px solid #007bff"}),onDoubleClick:function(){return m(!0)},children:[!j&&Object(R.jsx)("span",{children:"Signature"}),Object(R.jsx)("button",{style:{position:"absolute",right:0,top:0,background:"red",color:"white",border:"none",cursor:"pointer"},onClick:c,children:"X"}),Object(R.jsx)("div",{style:Object(o.a)(Object(o.a)({},D),{},{top:"-5px",left:"-5px"})}),Object(R.jsx)("div",{style:Object(o.a)(Object(o.a)({},D),{},{top:"-5px",right:"-5px"})}),Object(R.jsx)("div",{style:Object(o.a)(Object(o.a)({},D),{},{bottom:"-5px",left:"-5px"})}),Object(R.jsx)("div",{style:Object(o.a)(Object(o.a)({},D),{},{bottom:"-5px",right:"-5px"})})]}),O&&Object(R.jsx)(W,{isOpen:O,onClose:function(){return m(!1)},onSave:function(e){f(e),localStorage.setItem("signature-".concat(n,"-").concat(a,"-").concat(t),e),y("transparent")},existingSignature:j})]})},q=n(977),G=n(1047),U=n(739),Y=n.n(U),X=Object(f.a)((function(e){return{modal:{display:"flex",alignItems:"center",justifyContent:"center"},paper:{backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3)},successIcon:{color:"green",fontSize:"4rem"}}})),K=function(e){var t=e.open,n=e.handleClose,a=e.navigateHome,c=X();return Object(R.jsx)(T.a,{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",className:c.modal,open:t,onClose:n,closeAfterTransition:!0,BackdropComponent:q.a,BackdropProps:{timeout:500},children:Object(R.jsx)(G.a,{in:t,children:Object(R.jsxs)("div",{className:c.paper,children:[Object(R.jsx)(Y.a,{className:c.successIcon}),Object(R.jsx)("h2",{id:"transition-modal-title",children:"Has firmado de manera exitosa"}),Object(R.jsx)(k.a,{variant:"contained",color:"primary",onClick:a,children:"Seguir firmando archivos"})]})})})};n(740);function Q(){for(var e="#",t=0;t<6;t++)e+="0123456789ABCDEF"[Math.floor(16*Math.random())];return e}l.a.GlobalWorkerOptions.workerSrc="//cdnjs.cloudflare.com/ajax/libs/pdf.js/".concat(l.a.version,"/pdf.worker.min.js");var Z=Object(f.a)((function(e){return{container:{display:"flex",flexDirection:"column",alignItems:"center",minHeight:"100vh",overflow:"hidden"},pdfViewer:{flex:1},miniatures:{display:"block",overflow:"auto"},thumbnailImage:{width:"100%",cursor:"pointer"},documentButton:{cursor:"pointer",marginBottom:"5px"},thumbnailStyle:{margin:"5px 0",borderRadius:"5px",boxShadow:"0 3px 6px rgba(0, 0, 0, 0.1)"},addButton:{marginTop:e.spacing(2),backgroundColor:"#1976D2",color:"white",padding:"5px 15px",textTransform:"none",fontSize:"0.8rem","&:hover":{backgroundColor:"#1565C0"}}}})),$=function(){var e,t,n=Z(),s=Object(i.useState)(0),f=Object(r.a)(s,2),w=f[0],D=f[1],A=Object(i.useState)([]),F=Object(r.a)(A,2),B=F[0],z=F[1],T=Object(i.useState)(1),J=Object(r.a)(T,2),L=J[0],H=J[1],M=Object(i.useState)([]),W=Object(r.a)(M,2),E=W[0],q=W[1],G=Object(i.useState)(!0),U=Object(r.a)(G,2),Y=U[0],X=U[1],$=Object(i.useState)(null),_=Object(r.a)($,2),ee=_[0],te=_[1],ne=Object(i.useState)(JSON.parse(localStorage.getItem("signatureFields"))||{}),ae=Object(r.a)(ne,2),ce=ae[0],oe=ae[1],re=Object(i.useState)([]),ie=Object(r.a)(re,2),se=ie[0],le=ie[1],ue=Object(i.useRef)(null),de=Object(i.useState)(!1),be=Object(r.a)(de,2),je=be[0],fe=be[1],pe=Object(p.a)(),he=Object(h.a)(pe.breakpoints.down("sm")),Oe=function(){fe(!1)},me=Object(j.f)(),ge=[],xe=function(){q([]),oe([]),X(!0),te(null)},ve=null===(e=E[w])||void 0===e?void 0:e.name;return Object(R.jsxs)(O.a,{maxWidth:"lg",className:"pdfContainer",children:[Y?Object(R.jsx)(P,{onFilesSelected:function(e){q(Array.from(e)),X(!1),D(0);var t=Array.from(e).map((function(e){return new Promise((function(t,n){var a=new FileReader;a.onload=function(e){var a=new Uint8Array(e.target.result);l.a.getDocument(a).promise.then((function(e){t(e.numPages)})).catch(n)},a.onerror=n,a.readAsArrayBuffer(e)}))})),n=Array.from(e).map((function(e){return e.name}));le(n),Promise.all(t).then((function(e){z(e)}))}}):Object(R.jsxs)(m.a,{container:!0,spacing:2,className:n.pdfViewer,children:[Object(R.jsxs)(m.a,{item:!0,xs:12,sm:9,children:[E.length>0&&Object(R.jsx)(u.a,{ref:ue,file:E[w],onLoadSuccess:function(e){var t=e.numPages;z((function(e){var n=Object(c.a)(e);return n[w]=t,n}))},className:"documentContainer",children:Object(R.jsx)(d.a,{pageNumber:L,width:he?300:800,renderTextLayer:!he,renderAnnotationLayer:!1,style:{maxWidth:"min-content"}})}),Object(R.jsxs)("div",{style:{marginTop:"20px",display:"flex",justifyContent:"center"},children:[Object(R.jsx)(g.a,{onClick:function(){L>1&&H(L-1)},disabled:L<=1,children:Object(R.jsx)(N.a,{})}),Object(R.jsx)(g.a,{onClick:function(){L<B[w]&&H(L+1)},disabled:L>=B[w],children:Object(R.jsx)(I.a,{})})]})]}),E.length>0&&Object(R.jsxs)(m.a,{item:!0,xs:12,sm:3,className:"miniatures ".concat(n.miniatures),children:[Object(R.jsx)(x.a,{style:{maxHeight:"70vh",overflowY:"auto"},children:Object(R.jsx)(v.a,{children:E.map((function(e,t){var a=ee===t,c=se[t],o=Object(R.jsx)(y.a,{button:!0,onClick:function(){te(t)},className:n.documentButton,children:Object(R.jsx)(S.a,{primary:c})},t),r=B[t],i=Array.from({length:r},(function(t,a){return Object(R.jsx)(y.a,{button:!0,onClick:function(){return H(a+1),void D(ee)},className:n.thumbnailStyle,children:Object(R.jsx)(C.a,{children:Object(R.jsx)(u.a,{file:e,children:Object(R.jsx)(d.a,{pageNumber:a+1,width:170,renderTextLayer:!he,renderAnnotationLayer:!1,style:{maxWidth:"min-content"}})})})},a)}));return a?[o].concat(i):o}))})}),Object(R.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",width:"100%"},children:[Object(R.jsx)(k.a,{onClick:function(){var e=E[w].name,t={id:Object(b.a)(),pageNumber:L,x:0,y:0,width:200,height:50,backgroundColor:Q()};oe((function(n){return Object(o.a)(Object(o.a)({},n),{},Object(a.a)({},e,[].concat(Object(c.a)(n[e]||[]),[t])))})),localStorage.setItem("signatureFields",JSON.stringify(Object(o.a)(Object(o.a)({},ce),{},Object(a.a)({},e,[].concat(Object(c.a)(ce[e]||[]),[t])))))},variant:"contained",className:n.addButton,children:"Agregar campo de firma"}),Object(R.jsx)(k.a,{onClick:function(){fe(!0)},variant:"contained",style:{marginTop:"40px",fontSize:"1.1rem",backgroundColor:"#FF8C00",color:"#ffffff"},children:"Firmar"})]})]})]}),E.length>0&&Object(R.jsxs)(g.a,{onClick:xe,style:{position:"absolute",top:"10px",left:"10px"},children:[Object(R.jsx)(N.a,{})," Volver a seleccionar archivos"]}),ve&&(null===(t=ce[ve])||void 0===t?void 0:t.filter((function(e){return e.pageNumber===L})).map((function(e){return Object(R.jsx)(V,{id:e.id,documentId:ve,pageNumber:L,initialPosition:{x:e.x,y:e.y},size:{width:e.width,height:e.height},onRemove:function(){return t=ve,n=e.id,void oe((function(e){return Object(o.a)(Object(o.a)({},e),{},Object(a.a)({},t,e[t].filter((function(e){return e.id!==n}))))}));var t,n},onPositionChange:function(t,n){return function(e,t,n,c){oe((function(r){return Object(o.a)(Object(o.a)({},r),{},Object(a.a)({},e,r[e].map((function(e){return e.id===t?Object(o.a)(Object(o.a)({},e),{},{x:n,y:c}):e}))))})),localStorage.setItem("signatureFields",JSON.stringify(ge))}(ve,e.id,t,n)},onSizeChange:function(t,n){return function(e,t,n,c){oe((function(r){return Object(o.a)(Object(o.a)({},r),{},Object(a.a)({},e,r[e].map((function(e){return e.id===t?Object(o.a)(Object(o.a)({},e),{},{width:n,height:c}):e}))))})),localStorage.setItem("signatureFields",JSON.stringify(ce))}(ve,e.id,t,n)},backgroundColor:e.backgroundColor},e.id)}))),Object(R.jsx)(K,{open:je,handleClose:Oe,navigateHome:function(){Oe(),me("/dashboard/firmaya"),xe()}})]})};t.default=function(){return Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)("h1",{style:{textAlign:"center",marginTop:"50px",marginBottom:"50px",color:"rgb(226 113 17)"},children:"Firma Ya"}),Object(R.jsx)($,{})]})}},632:function(e,t){},671:function(e,t){},672:function(e,t){},740:function(e,t,n){},771:function(e,t){},772:function(e,t){},773:function(e,t){}}]);
//# sourceMappingURL=18.f1da5c03.chunk.js.map